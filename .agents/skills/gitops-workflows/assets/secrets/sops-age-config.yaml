# .sops.yaml - SOPS configuration with age encryption
# Place in repository root
creation_rules:
  # Production secrets (encrypted with prod age key)
  - path_regex: production/.*\.yaml$
    encrypted_regex: ^(data|stringData)$
    age: age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p

  # Staging secrets (encrypted with staging age key)
  - path_regex: staging/.*\.yaml$
    encrypted_regex: ^(data|stringData)$
    age: age1staging... # Replace with your staging age public key

  # Development secrets (encrypted with dev age key)
  - path_regex: dev/.*\.yaml$
    encrypted_regex: ^(data|stringData)$
    age: age1dev... # Replace with your dev age public key

# Generate age keys:
# age-keygen -o prod-key.txt
# age-keygen -o staging-key.txt
# age-keygen -o dev-key.txt

# Encrypt secret:
# kubectl create secret generic my-secret --dry-run=client -o yaml \
#   --from-literal=password=supersecret > secret.yaml
# sops -e secret.yaml > secret.enc.yaml
# git add secret.enc.yaml .sops.yaml

# Flux integration:
# kubectl create secret generic sops-age \
#   --from-file=age.agekey=./prod-key.txt \
#   -n flux-system
